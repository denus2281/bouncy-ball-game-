
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>Крутой Попрыгунчик 2025</title>
<style>
  body { margin:0; background:#000; display:flex; flex-direction:column; align-items:center; font-family:'Arial Black',sans-serif; }
  #score { position:absolute; top:10px; left:20px; color:#fff; font-size:1.8em; text-shadow:0 0 5px #000; }
  canvas { margin-top:50px; border-radius:15px; box-shadow:0 0 20px #0ff inset, 0 0 30px #0ff; cursor:pointer; }
  #buttons { margin-top:20px; display:flex; gap:15px; }
  button { padding:12px 25px; font-size:1em; border:none; border-radius:10px; background:#0ff; color:#000; cursor:pointer; box-shadow:0 0 10px #0ff inset; transition:background 0.3s, transform 0.2s; }
  button:hover { background:#0cc; transform:scale(1.05); }
</style>
</head>
<body>
<div id="score">Очки: 0</div>
<canvas id="gameCanvas" width="480" height="640"></canvas>
<div id="buttons">
  <button id="increaseSize">Увеличить попрыгунчика</button>
  <button id="restart">Рестарт</button>
</div>
<script>
const c=document.getElementById('gameCanvas');
const ctx=c.getContext('2d');
const scoreEl=document.getElementById('score');
const btnIncrease=document.getElementById('increaseSize');
const btnRestart=document.getElementById('restart');

let player={ x:220, y:580, w:50, h:50, speed:8, dx:0, dy:0, jump:false, sizeMultiplier:1, color:'#00ffff' };
const platforms=[]; let score=0; let gameOver=false; let spawnTimer=0; let spawnInterval=120;

function createPlatform(y) {
  const w=80+Math.random()*80;
  const x=Math.random()*(c.width-w);
  platforms.push({ x, y, w, h:12, passed:false });
}

for(let i=0; i<10; i++) createPlatform(600 - i*120);

document.addEventListener('keydown', e => {
  if(e.key==='ArrowLeft') player.dx=-player.speed;
  if(e.key==='ArrowRight') player.dx=player.speed;
  if(e.key===' ' && !player.jump){ player.jump=true; player.dy=-16; }
});
document.addEventListener('keyup', e => {
  if(e.key==='ArrowLeft'||e.key==='ArrowRight') player.dx=0;
});

btnIncrease.onclick=()=>{
  player.sizeMultiplier+=0.2;
  player.w=50*player.sizeMultiplier;
  player.h=50*player.sizeMultiplier;
  player.color=`hsl(${Math.random()*360}, 100%, 50%)`; // меняется цвет
};

btnRestart.onclick=()=>{
  resetGame();
};

function resetGame() {
  player.x=220; player.y=580; player.w=50; player.h=50; player.sizeMultiplier=1; player.color='#00ffff';
  platforms.length=0;
  for(let i=0; i<10; i++) createPlatform(600 - i*120);
  score=0; scoreEl.innerText='Очки: 0'; gameOver=false; spawnInterval=120; spawnTimer=0;
}

function gameLoop() {
  if(gameOver){
    ctx.fillStyle='rgba(0,0,0,0.7)';
    ctx.fillRect(0,0,c.width,c.height);
    ctx.fillStyle='white'; ctx.font='40px "Arial Black"'; ctx.textAlign='center'; ctx.fillText('Игра окончена', c.width/2, c.height/2);
    ctx.font='20px Arial'; ctx.fillText('Нажмите "Рестарт"', c.width/2, c.height/2+40);
    return;
  }
  ctx.clearRect(0,0,c.width,c.height);
  // движение игрока
  player.x+=player.dx;
  if(player.x<0) player.x=0;
  if(player.x+player.w>c.width) player.x=c.width-player.w;
  // гравитация
  if(player.jump){ player.dy+=0.7; player.y+=player.dy; }
  if(player.y+player.h>=c.height){ player.y=c.height-player.h; player.jump=false; player.dy=0; }

  // проверка на платформы
  for(let p of platforms){
    if(
      player.y+player.h>=p.y &&
      player.y+player.h<=p.y+5 &&
      player.x+player.w>p.x &&
      player.x<p.x+p.w
    ){
      if(player.dy>0){
        player.y=p.y-player.h;
        player.jump=false; player.dy=0;
      }
    }
  }

  // обновление платформ
  for(let p of platforms){ p.y+=2+score/60; }
  if(platforms[0].y>640){ platforms.shift(); createPlatform(-10); score++; scoreEl.innerText='Очки: '+score; }

  // создание новых платформ
  spawnTimer+=16;
  if(spawnTimer>spawnInterval){
    spawnTimer=0; spawnInterval*=0.99; // ускорение
    createPlatform(-10);
  }

  // рисуем платформы
  ctx.fillStyle='linear-gradient(135deg, #0ff, #00f)';
  for(let p of platforms){ ctx.fillRect(p.x,p.y,p.w,p.h); }

  // рисуем игрока
  ctx.fillStyle=player.color;
  ctx.fillRect(player.x,player.y,player.w,player.h);

  // падение
  if(player.y>640){ gameOver=true; }

  // очки
  ctx.fillStyle='white'; ctx.font='20px Arial'; ctx.fillText('Очки: '+score,10,25);

  requestAnimationFrame(gameLoop);
}
gameLoop();
</script>
</body>
</html>
